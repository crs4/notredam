/*
 * Ext JS Library 3.1+
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.namespace("Ext.air","Ext.sql");Ext.Template.prototype.compile=function(){var f=Ext.util.Format;var b=this.disableFormats!==true;var h=0;var a=[];var c=this;var e=function(k,j,r,q,n,u){if(h!=n){var l={type:1,value:u.substr(h,n-h)};a.push(l)}h=n+k.length;if(r&&b){if(q){var t=/^\s*['"](.*)["']\s*$/;q=q.split(/,(?=(?:[^"]*"[^"]*")*(?![^"]*"))/);for(var o=0,p=q.length;o<p;o++){q[o]=q[o].replace(t,"$1")}q=[""].concat(q)}else{q=[""]}if(r.substr(0,5)!="this."){var l={type:3,value:j,format:f[r],args:q,scope:f};a.push(l)}else{var l={type:3,value:j,format:c[r.substr(5)],args:q,scope:c};a.push(l)}}else{var l={type:2,value:j};a.push(l)}return k};var d=this.html.replace(this.re,e);if(h!=(d.length-1)){var g={type:1,value:d.substr(h,d.length-h)};a.push(g)}this.compiled=function(k){function j(l){switch(l.type){case 1:return l.value;case 2:return(k[l.value]?k[l.value]:"");default:l.args[0]=k[l.value];return l.format.apply(l.scope,l.args)}}return a.map(j).join("")};return this};Ext.Template.prototype.call=function(c,b,a){return this[c](b,a)};Ext.DomQuery=function(){var cache={},simpleCache={},valueCache={};var nonSpace=/\S/;var trimRe=/^\s+|\s+$/g;var tplRe=/\{(\d+)\}/g;var modeRe=/^(\s?[\/>+~]\s?|\s|$)/;var tagTokenRe=/^(#)?([\w-\*]+)/;var nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/;function child(p,index){var i=0;var n=p.firstChild;while(n){if(n.nodeType==1){if(++i==index){return n}}n=n.nextSibling}return null}function next(n){while((n=n.nextSibling)&&n.nodeType!=1){}return n}function prev(n){while((n=n.previousSibling)&&n.nodeType!=1){}return n}function children(d){var n=d.firstChild,ni=-1;while(n){var nx=n.nextSibling;if(n.nodeType==3&&!nonSpace.test(n.nodeValue)){d.removeChild(n)}else{n.nodeIndex=++ni}n=nx}return this}function byClassName(c,a,v){if(!v){return c}var r=[],ri=-1,cn;for(var i=0,ci;ci=c[i];i++){if((" "+ci.className+" ").indexOf(v)!=-1){r[++ri]=ci}}return r}function attrValue(n,attr){if(!n.tagName&&typeof n.length!="undefined"){n=n[0]}if(!n){return null}if(attr=="for"){return n.htmlFor}if(attr=="class"||attr=="className"){return n.className}return n.getAttribute(attr)||n[attr]}function getNodes(ns,mode,tagName){var result=[],ri=-1,cs;if(!ns){return result}tagName=tagName||"*";if(typeof ns.getElementsByTagName!="undefined"){ns=[ns]}if(!mode){for(var i=0,ni;ni=ns[i];i++){cs=ni.getElementsByTagName(tagName);for(var j=0,ci;ci=cs[j];j++){result[++ri]=ci}}}else{if(mode=="/"||mode==">"){var utag=tagName.toUpperCase();for(var i=0,ni,cn;ni=ns[i];i++){cn=ni.children||ni.childNodes;for(var j=0,cj;cj=cn[j];j++){if(cj.nodeName==utag||cj.nodeName==tagName||tagName=="*"){result[++ri]=cj}}}}else{if(mode=="+"){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(n&&(n.nodeName==utag||n.nodeName==tagName||tagName=="*")){result[++ri]=n}}}else{if(mode=="~"){for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)&&(n.nodeType!=1||(tagName=="*"||n.tagName.toLowerCase()!=tagName))){}if(n){result[++ri]=n}}}}}}return result}function concat(a,b){if(b.slice){return a.concat(b)}for(var i=0,l=b.length;i<l;i++){a[a.length]=b[i]}return a}function byTag(cs,tagName){if(cs.tagName||cs==document){cs=[cs]}if(!tagName){return cs}var r=[],ri=-1;tagName=tagName.toLowerCase();for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType==1&&ci.tagName.toLowerCase()==tagName){r[++ri]=ci}}return r}function byId(cs,attr,id){if(cs.tagName||cs==document){cs=[cs]}if(!id){return cs}var r=[],ri=-1;for(var i=0,ci;ci=cs[i];i++){if(ci&&ci.id==id){r[++ri]=ci;return r}}return r}function byAttribute(cs,attr,value,op,custom){var r=[],ri=-1,st=custom=="{";var f=Ext.DomQuery.operators[op];for(var i=0,ci;ci=cs[i];i++){var a;if(st){a=Ext.DomQuery.getStyle(ci,attr)}else{if(attr=="class"||attr=="className"){a=ci.className}else{if(attr=="for"){a=ci.htmlFor}else{if(attr=="href"){a=ci.getAttribute("href",2)}else{a=ci.getAttribute(attr)}}}}if((f&&f(a,value))||(!f&&a)){r[++ri]=ci}}return r}function byPseudo(cs,name,value){return Ext.DomQuery.pseudos[name](cs,value)}eval("var batch = 30803;");var key=30803;function nodup(cs){if(!cs){return[]}var len=cs.length,c,i,r=cs,cj,ri=-1;if(!len||typeof cs.nodeType!="undefined"||len==1){return cs}var d=++key;cs[0]._nodup=d;for(i=1;c=cs[i];i++){if(c._nodup!=d){c._nodup=d}else{r=[];for(var j=0;j<i;j++){r[++ri]=cs[j]}for(j=i+1;cj=cs[j];j++){if(cj._nodup!=d){cj._nodup=d;r[++ri]=cj}}return r}}return r}function quickDiff(c1,c2){var len1=c1.length;if(!len1){return c2}var d=++key;for(var i=0;i<len1;i++){c1[i]._qdiff=d}var r=[];for(var i=0,len=c2.length;i<len;i++){if(c2[i]._qdiff!=d){r[r.length]=c2[i]}}return r}function quickId(ns,mode,root,id){if(ns==root){var d=root.ownerDocument||root;return d.getElementById(id)}ns=getNodes(ns,mode,"*");return byId(ns,null,id)}function search(path,root,type){type=type||"select";var n=root||document;var q=path,mode,lq;var tk=Ext.DomQuery.matchers;var tklen=tk.length;var mm;var lmode=q.match(modeRe);if(lmode&&lmode[1]){mode=lmode[1].replace(trimRe,"");q=q.replace(lmode[1],"")}while(path.substr(0,1)=="/"){path=path.substr(1)}while(q&&lq!=q){lq=q;var tm=q.match(tagTokenRe);if(type=="select"){if(tm){if(tm[1]=="#"){n=quickId(n,mode,root,tm[2])}else{n=getNodes(n,mode,tm[2])}q=q.replace(tm[0],"")}else{if(q.substr(0,1)!="@"){n=getNodes(n,mode,"*")}}}else{if(tm){if(tm[1]=="#"){n=byId(n,null,tm[2])}else{n=byTag(n,tm[2])}q=q.replace(tm[0],"")}}while(!(mm=q.match(modeRe))){var matched=false;for(var j=0;j<tklen;j++){var t=tk[j];var m=q.match(t.re);if(m){switch(j){case 0:n=byClassName(n,null," "+m[1]+" ");break;case 1:n=byPseudo(n,m[1],m[2]);break;case 2:n=byAttribute(n,m[2],m[4],m[3],m[1]);break;case 3:n=byId(n,null,m[1]);break;case 4:return{firstChild:{nodeValue:attrValue(n,m[1])}}}q=q.replace(m[0],"");matched=true;break}}if(!matched){throw'Error parsing selector, parsing failed at "'+q+'"'}}if(mm[1]){mode=mm[1].replace(trimRe,"");q=q.replace(mm[1],"")}}return nodup(n)}return{getStyle:function(el,name){return Ext.fly(el).getStyle(name)},compile:function(path,type){return function(root){return search(path,root,type)}},select:function(path,root,type){if(!root||root==document){root=document}if(typeof root=="string"){root=document.getElementById(root)}var paths=path.split(",");var results=[];for(var i=0,len=paths.length;i<len;i++){var p=paths[i].replace(trimRe,"");if(!cache[p]){cache[p]=Ext.DomQuery.compile(p);if(!cache[p]){throw p+" is not a valid selector"}}var result=cache[p](root);if(result&&result!=document){results=results.concat(result)}}if(paths.length>1){return nodup(results)}return results},selectNode:function(path,root){return Ext.DomQuery.select(path,root)[0]},selectValue:function(path,root,defaultValue){path=path.replace(trimRe,"");if(!valueCache[path]){valueCache[path]=Ext.DomQuery.compile(path,"select")}var n=valueCache[path](root);n=n[0]?n[0]:n;var v=(n&&n.firstChild?n.firstChild.nodeValue:null);return((v===null||v===undefined||v==="")?defaultValue:v)},selectNumber:function(path,root,defaultValue){var v=Ext.DomQuery.selectValue(path,root,defaultValue||0);return parseFloat(v)},is:function(el,ss){if(typeof el=="string"){el=document.getElementById(el)}var isArray=Ext.isArray(el);var result=Ext.DomQuery.filter(isArray?el:[el],ss);return isArray?(result.length==el.length):(result.length>0)},filter:function(els,ss,nonMatches){ss=ss.replace(trimRe,"");if(!simpleCache[ss]){simpleCache[ss]=Ext.DomQuery.compile(ss,"simple")}var result=simpleCache[ss](els);return nonMatches?quickDiff(result,els):result},matchers:[{re:/^\.([\w-]+)/,select:'n = byClassName(n, null, " {1} ");'},{re:/^\:([\w-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'},{re:/^#([\w-]+)/,select:'n = byId(n, null, "{1}");'},{re:/^@([\w-]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(a,v){return a==v},"!=":function(a,v){return a!=v},"^=":function(a,v){return a&&a.substr(0,v.length)==v},"$=":function(a,v){return a&&a.substr(a.length-v.length)==v},"*=":function(a,v){return a&&a.indexOf(v)!==-1},"%=":function(a,v){return(a%v)==0},"|=":function(a,v){return a&&(a==v||a.substr(0,v.length+1)==v+"-")},"~=":function(a,v){return a&&(" "+a+" ").indexOf(" "+v+" ")!=-1}},pseudos:{"first-child":function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.previousSibling)&&n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},"last-child":function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},"nth-child":function(c,a){var r=[],ri=-1;var m=nthRe.exec(a=="even"&&"2n"||a=="odd"&&"2n+1"||!nthRe2.test(a)&&"n+"+a||a);var f=(m[1]||1)-0,l=m[2]-0;for(var i=0,n;n=c[i];i++){var pn=n.parentNode;if(batch!=pn._batch){var j=0;for(var cn=pn.firstChild;cn;cn=cn.nextSibling){if(cn.nodeType==1){cn.nodeIndex=++j}}pn._batch=batch}if(f==1){if(l==0||n.nodeIndex==l){r[++ri]=n}}else{if((n.nodeIndex+l)%f==0){r[++ri]=n}}}return r},"only-child":function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(!prev(ci)&&!next(ci)){r[++ri]=ci}}return r},empty:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var cns=ci.childNodes,j=0,cn,empty=true;while(cn=cns[j]){++j;if(cn.nodeType==1||cn.nodeType==3){empty=false;break}}if(empty){r[++ri]=ci}}return r},contains:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if((ci.textContent||ci.innerText||"").indexOf(v)!=-1){r[++ri]=ci}}return r},nodeValue:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.firstChild&&ci.firstChild.nodeValue==v){r[++ri]=ci}}return r},checked:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.checked==true){r[++ri]=ci}}return r},not:function(c,ss){return Ext.DomQuery.filter(c,ss,true)},any:function(c,selectors){var ss=selectors.split("|");var r=[],ri=-1,s;for(var i=0,ci;ci=c[i];i++){for(var j=0;s=ss[j];j++){if(Ext.DomQuery.is(ci,s)){r[++ri]=ci;break}}}return r},odd:function(c){return this["nth-child"](c,"odd")},even:function(c){return this["nth-child"](c,"even")},nth:function(c,a){return c[a-1]||[]},first:function(c){return c[0]||[]},last:function(c){return c[c.length-1]||[]},has:function(c,ss){var s=Ext.DomQuery.select;var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(s(ss,ci).length>0){r[++ri]=ci}}return r},next:function(c,ss){var is=Ext.DomQuery.is;var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=next(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r},prev:function(c,ss){var is=Ext.DomQuery.is;var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=prev(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r}}}}();Ext.query=Ext.DomQuery.select;Date.precompileFormats=function(d){var b=d.split("|");for(var c=0,a=b.length;c<a;c++){Date.createFormat(b[c]);Date.createParser(b[c])}};Date.precompileFormats("D n/j/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|YmdHis|F d, Y|l, F d, Y|H:i:s|g:i A|g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|m/d/y|m/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|Y-m-d H:i:s|d/m/y|d/m/Y|d-m-y|d-m-Y|d/m|d-m|dm|dmy|dmY|Y-m-d|l|D m/d|D m/d/Y|m/d/Y");Ext.ColorPalette.prototype.tpl=new Ext.XTemplate('<tpl for="."><a href="#" class="color-{.}" hidefocus="on"><em><span style="background:#{.}" unselectable="on">&#160;</span></em></a></tpl>');Ext.grid.GroupingView.prototype.startTpl=new Ext.XTemplate('<div id="{groupId}" class="x-grid-group {cls}">','<div id="{groupId}-hd" class="x-grid-group-hd" style="{style}"><div>{text}</div></div>','<div id="{groupId}-bd" class="x-grid-group-body">');Ext.layout.MenuLayout.itemTpl=Ext.layout.MenuLayout.prototype.itemTpl=new Ext.XTemplate('<li id="{itemId}" class="{itemCls}">','<tpl if="needsIcon">','<img src="{icon}" class="{iconCls}">',"</tpl>","</li>");Ext.menu.Item.prototype.itemTpl=new Ext.XTemplate('<a id="{id}" class="{cls}" hidefocus="true" unselectable="on" href="{href}"','<tpl if="hrefTarget">',' target="{hrefTarget}"',"</tpl>",">",'<img src="{icon}" class="x-menu-item-icon {iconCls}">','<span class="x-menu-item-text">{text}</span>',"</a>");Ext.ListView.prototype.internalTpl=new Ext.XTemplate('<div class="x-list-header"><div class="x-list-header-inner">','<tpl for="columns">','<div style="width:{width}%;text-align:{align};"><em unselectable="on" id="',this.id,'-xlhd-{#}">',"{header}","</em></div>","</tpl>",'<div class="x-clear"></div>',"</div></div>",'<div class="x-list-body"><div class="x-list-body-inner">',"</div></div>");Ext.ListView.prototype.tpl=new Ext.XTemplate('<tpl for="rows">',"<dl>",'<tpl for="parent.columns">','<dt style="width:{width}%;text-align:{align};"><em unselectable="on">',"{[values.tpl.apply(parent)]}","</em></dt>","</tpl>",'<div class="x-clear"></div>',"</dl>","</tpl>");Ext.air.FileProvider=function(a){Ext.air.FileProvider.superclass.constructor.call(this);this.defaultState={mainWindow:{width:780,height:580,x:10,y:10}};Ext.apply(this,a);this.state=this.readState();var b=this;air.NativeApplication.nativeApplication.addEventListener("exiting",function(){b.saveState()})};Ext.extend(Ext.air.FileProvider,Ext.state.Provider,{file:"extstate.data",readState:function(){var b=air.File.applicationStorageDirectory.resolvePath(this.file);if(!b.exists){return this.defaultState||{}}var c=new air.FileStream();c.open(b,air.FileMode.READ);var a=c.readObject();c.close();return a||this.defaultState||{}},saveState:function(a,b){var c=air.File.applicationStorageDirectory.resolvePath(this.file);var d=new air.FileStream();d.open(c,air.FileMode.WRITE);d.writeObject(this.state);d.close()}});Ext.air.NativeObservable=Ext.extend(Ext.util.Observable,{addListener:function(b){this.proxiedEvents=this.proxiedEvents||{};if(!this.proxiedEvents[b]){var a=this;var c=function(){var d=Array.prototype.slice.call(arguments,0);d.unshift(b);a.fireEvent.apply(a,d)};this.proxiedEvents[b]=c;this.getNative().addEventListener(b,c)}Ext.air.NativeObservable.superclass.addListener.apply(this,arguments)}});Ext.air.NativeObservable.prototype.on=Ext.air.NativeObservable.prototype.addListener;Ext.air.NativeWindow=function(d){Ext.apply(this,d);this.id=this.id||Ext.uniqueId();this.addEvents("close","closing","move","moving","resize","resizing","displayStateChange","displayStateChanging");Ext.air.NativeWindow.superclass.constructor.call(this);if(!this.instance){var n=new air.NativeWindowInitOptions();n.systemChrome=this.chrome;n.type=this.type;n.resizable=this.resizable;n.minimizable=this.minimizable;n.maximizable=this.maximizable;n.transparent=this.transparent;this.loader=window.runtime.flash.html.HTMLLoader.createRootWindow(false,n,false);if(this.file){this.loader.load(new air.URLRequest(this.file))}else{this.loader.loadString(this.html||"")}this.instance=this.loader.window.nativeWindow}else{this.loader=this.instance.stage.getChildAt(0)}var l=Ext.state.Manager;var j=air.Screen.mainScreen.visibleBounds;var a=l.get(this.id)||{};l.set(this.id,a);var g=this.instance;var c=Math.max(a.width||this.width,100);var m=Math.max(a.height||this.height,100);var f=j.x+((j.width/2)-(c/2));var e=j.y+((j.height/2)-(m/2));var k=!Ext.isEmpty(a.x,false)?a.x:(!Ext.isEmpty(this.x,false)?this.x:f);var h=!Ext.isEmpty(a.y,false)?a.y:(!Ext.isEmpty(this.y,false)?this.y:e);g.width=c;g.height=m;g.x=k;g.y=h;g.addEventListener("move",function(){if(g.displayState!=air.NativeWindowDisplayState.MINIMIZED&&g.width>100&&g.height>100){a.x=g.x;a.y=g.y}});g.addEventListener("resize",function(){if(g.displayState!=air.NativeWindowDisplayState.MINIMIZED&&g.width>100&&g.height>100){a.width=g.width;a.height=g.height}});Ext.air.NativeWindowManager.register(this);this.on("close",this.unregister,this);if(this.minimizeToTray){this.initMinimizeToTray(this.trayIcon,this.trayMenu)}};Ext.extend(Ext.air.NativeWindow,Ext.air.NativeObservable,{chrome:"standard",type:"normal",width:600,height:400,resizable:true,minimizable:true,maximizable:true,transparent:false,getNative:function(){return this.instance},getCenterXY:function(){var a=air.Screen.mainScreen.visibleBounds;return{x:a.x+((a.width/2)-(this.width/2)),y:a.y+((a.height/2)-(this.height/2))}},show:function(){if(this.trayed){Ext.air.SystemTray.hideIcon();this.trayed=false}this.instance.visible=true},activate:function(){this.show();this.instance.activate()},hide:function(){this.instance.visible=false},close:function(){this.instance.close()},isMinimized:function(){return this.instance.displayState==air.NativeWindowDisplayState.MINIMIZED},isMaximized:function(){return this.instance.displayState==air.NativeWindowDisplayState.MAXIMIZED},moveTo:function(a,b){this.x=this.instance.x=a;this.y=this.instance.y=b},fullscreen:function(a){var b=runtime.flash.display.StageDisplayState;this.instance.stage.displayState=a?b.FULL_SCREEN:b.FULL_SCREEN_INTERACTIVE},bringToFront:function(){this.instance.orderToFront()},bringInFrontOf:function(a){this.instance.orderInFrontOf(a.instance?a.instance:a)},sendToBack:function(){this.instance.orderToBack()},sendBehind:function(a){this.instance.orderInBackOf(a.instance?a.instance:a)},resize:function(b,a){this.width=this.instance.width=b;this.height=this.instance.height=a},unregister:function(){Ext.air.NativeWindowManager.unregister(this)},initMinimizeToTray:function(b,c){var a=Ext.air.SystemTray;a.setIcon(b,this.trayTip);this.on("displayStateChanging",function(d){if(d.afterDisplayState=="minimized"){d.preventDefault();this.hide();a.showIcon();this.trayed=true}},this);a.on("click",function(){this.activate()},this);if(c){a.setMenu(c)}}});Ext.air.NativeWindow.getRootWindow=function(){return air.NativeApplication.nativeApplication.openedWindows[0]};Ext.air.NativeWindow.getRootHtmlWindow=function(){return Ext.air.NativeWindow.getRootWindow().stage.getChildAt(0).window};Ext.air.NativeWindowGroup=function(){var a={};return{register:function(b){a[b.id]=b},unregister:function(b){delete a[b.id]},get:function(b){return a[b]},closeAll:function(){for(var b in a){if(a.hasOwnProperty(b)){a[b].close()}}},each:function(c,b){for(var d in a){if(a.hasOwnProperty(d)){if(c.call(b||a[d],a[d])===false){return}}}}}};Ext.air.NativeWindowManager=new Ext.air.NativeWindowGroup();Ext.sql.Connection=function(a){Ext.apply(this,a);Ext.sql.Connection.superclass.constructor.call(this);this.addEvents({open:true,close:true})};Ext.extend(Ext.sql.Connection,Ext.util.Observable,{maxResults:10000,openState:false,open:function(a){},close:function(){},exec:function(a){},execBy:function(b,a){},query:function(a){},queryBy:function(b,a){},isOpen:function(){return this.openState},getTable:function(a,b){return new Ext.sql.Table(this,a,b)},createTable:function(a){var h=a.name;var j=a.key;var d=a.fields;if(!Ext.isArray(d)){d=d.items}var b=[];for(var c=0,g=d.length;c<g;c++){var e=d[c],l=e.name;switch(e.type){case"int":case"bool":case"boolean":l+=" INTEGER";break;case"float":l+=" REAL";break;default:l+=" TEXT"}if(e.allowNull===false||e.name==j){l+=" NOT NULL"}if(e.name==j){l+=" PRIMARY KEY"}if(e.unique===true){l+=" UNIQUE"}b[b.length]=l}var k=["CREATE TABLE IF NOT EXISTS ",h," (",b.join(","),")"].join("");this.exec(k)}});Ext.sql.Connection.getInstance=function(a,b){if(Ext.isAir){return new Ext.sql.AirConnection(b)}else{return new Ext.sql.GearsConnection(b)}};Ext.sql.SQLiteStore=Ext.extend(Ext.data.Store,{constructor:function(a){a=a||{};a.reader=new Ext.data.JsonReader({id:a.key,fields:a.fields});var b=Ext.sql.Connection.getInstance();b.open(a.dbFile);b.createTable({name:a.tableName,key:a.key,fields:a.reader.recordType.prototype.fields});Ext.sql.SQLiteStore.superclass.constructor.call(this,a);this.proxy=new Ext.sql.Proxy(b,a.tableName,a.key,this,false)}});Ext.sql.Table=function(c,a,b){this.conn=c;this.name=a;this.keyName=b};Ext.sql.Table.prototype={update:function(b){var a=this.keyName+" = ?";return this.updateBy(b,a,[b[this.keyName]])},updateBy:function(h,f,d){var g="UPDATE "+this.name+" set ";var b=[],c=[];for(var e in h){if(h.hasOwnProperty(e)){b[b.length]=e+" = ?";c[c.length]=h[e]}}for(var e in d){if(d.hasOwnProperty(e)){c[c.length]=d[e]}}g=[g,b.join(",")," WHERE ",f].join("");return this.conn.execBy(g,c)},insert:function(f){var e="INSERT into "+this.name+" ";var b=[],g=[],c=[];for(var d in f){if(f.hasOwnProperty(d)){b[b.length]=d;g[g.length]="?";c[c.length]=f[d]}}e=[e,"(",b.join(","),") VALUES (",g.join(","),")"].join("");return this.conn.execBy(e,c)},lookup:function(a){return this.selectBy("where "+this.keyName+" = ?",[a])[0]||null},exists:function(a){return !!this.lookup(a)},save:function(a){if(this.exists(a[this.keyName])){this.update(a)}else{this.insert(a)}},select:function(a){return this.selectBy(a,null)},selectBy:function(b,a){var c="select * from "+this.name;if(b){c+=" "+b}a=a||{};return this.conn.queryBy(c,a)},remove:function(a){this.deleteBy(a,null)},removeBy:function(b,a){var c="delete from "+this.name;if(b){c+=" where "+b}a=a||{};this.conn.execBy(c,a)}};Ext.sql.Proxy=function(e,d,c,b,a){Ext.sql.Proxy.superclass.constructor.call(this);this.conn=e;this.table=this.conn.getTable(d,c);this.store=b;if(a!==true){this.store.on("add",this.onAdd,this);this.store.on("update",this.onUpdate,this);this.store.on("remove",this.onRemove,this)}};Ext.sql.Proxy.DATE_FORMAT="Y-m-d H:i:s";Ext.extend(Ext.sql.Proxy,Ext.data.DataProxy,{load:function(c,e,j,k,l){if(!this.conn.isOpen()){this.conn.on("open",function(){this.load(c,e,j,k,l)},this,{single:true});return}if(this.fireEvent("beforeload",this,c,e,j,k,l)!==false){var g=c.where||"";var f=c.args||[];var h=c.groupBy;var d=c.sort;var a=c.dir;if(h||d){g+=" ORDER BY ";if(h&&h!=d){g+=h+" ASC, "}g+=d+" "+(a||"ASC")}var b=this.table.selectBy(g,f);this.onLoad({callback:j,scope:k,arg:l,reader:e},b)}else{j.call(k||this,null,l,false)}},onLoad:function(c,b,f,d){if(b===false){this.fireEvent("loadexception",this,null,c.arg,f);c.callback.call(c.scope||window,null,c.arg,false);return}var a=c.reader.readRecords(b);this.fireEvent("load",this,b,c.arg);c.callback.call(c.scope||window,a,c.arg,true)},processData:function(g){var a=this.store.fields;var d={};for(var c in g){var e=a.key(c),b=g[c];if(e){if(e.type=="date"){d[c]=b?b.format(Ext.sql.Proxy.DATE_FORMAT,10):""}else{if(e.type=="boolean"){d[c]=b?1:0}else{d[c]=b}}}}return d},onUpdate:function(d,a){var c=a.getChanges();var b=this.table.keyName;this.table.updateBy(this.processData(c),b+" = ?",[a.data[b]]);a.commit(true)},onAdd:function(e,b,c){for(var d=0,a=b.length;d<a;d++){this.table.insert(this.processData(b[d].data))}},onRemove:function(d,a,b){var c=this.table.keyName;this.table.removeBy(c+" = ?",[a.data[c]])}});Ext.sql.AirConnection=Ext.extend(Ext.sql.Connection,{open:function(a){this.conn=new air.SQLConnection();var b=air.File.applicationDirectory.resolvePath(a);this.conn.open(b);this.openState=true;this.fireEvent("open",this)},close:function(){this.conn.close();this.fireEvent("close",this)},createStatement:function(a){var b=new air.SQLStatement();b.sqlConnection=this.conn;return b},exec:function(b){var a=this.createStatement("exec");a.text=b;a.execute()},execBy:function(c,a){var b=this.createStatement("exec");b.text=c;this.addParams(b,a);b.execute()},query:function(b){var a=this.createStatement("query");a.text=b;a.execute(this.maxResults);return this.readResults(a.getResult())},queryBy:function(c,a){var b=this.createStatement("query");b.text=c;this.addParams(b,a);b.execute(this.maxResults);return this.readResults(b.getResult())},addParams:function(d,b){if(!b){return}for(var c in b){if(b.hasOwnProperty(c)){if(!isNaN(c)){var a=b[c];if(Ext.isDate(a)){a=a.format(Ext.sql.Proxy.DATE_FORMAT)}d.parameters[parseInt(c)]=a}else{d.parameters[":"+c]=b[c]}}}return d},readResults:function(b){var d=[];if(b&&b.data){var a=b.data.length;for(var c=0;c<a;c++){d[d.length]=b.data[c]}}return d}});Ext.air.SystemTray=function(){var d=air.NativeApplication.nativeApplication;var b,a=false,c;if(air.NativeApplication.supportsSystemTrayIcon){b=d.icon;a=true}if(air.NativeApplication.supportsDockIcon){b=d.icon}return{setIcon:function(f,g,h){if(!f){return}var e=new air.Loader();e.contentLoaderInfo.addEventListener(air.Event.COMPLETE,function(j){c=new runtime.Array(j.target.content.bitmapData);if(h){f.bitmaps=c}});e.load(new air.URLRequest(f));if(g&&air.NativeApplication.supportsSystemTrayIcon){d.icon.tooltip=g}},bounce:function(e){b.bounce(e)},on:function(e,g,f){b.addEventListener(e,function(){g.apply(f||this,arguments)})},hideIcon:function(){if(!b){return}b.bitmaps=[]},showIcon:function(){if(!b){return}b.bitmaps=c},setMenu:function(l,g){if(!b){return}var k=new air.NativeMenu();for(var h=0,e=l.length;h<e;h++){var f=l[h];if(f=="-"){k.addItem(new air.NativeMenuItem("",true))}else{var j=k.addItem(Ext.air.MenuItem(f));if(f.menu||(f.initialConfig&&f.initialConfig.menu)){j.submenu=Ext.air.SystemTray.setMenu(f.menu||f.initialConfig.menu,k)}}if(!g){b.menu=k}}return k}}}();Ext.air.DragType={TEXT:"text/plain",HTML:"text/html",URL:"text/uri-list",BITMAP:"image/x-vnd.adobe.air.bitmap",FILES:"application/x-vnd.adobe.air.file-list"};Ext.apply(Ext.EventObjectImpl.prototype,{hasFormat:function(c){if(this.browserEvent.dataTransfer){for(var b=0,a=this.browserEvent.dataTransfer.types.length;b<a;b++){if(this.browserEvent.dataTransfer.types[b]==c){return true}}}return false},getData:function(a){return this.browserEvent.dataTransfer.getData(a)}});Ext.air.Sound={play:function(c,b){var a=air.File.applicationDirectory.resolvePath(c);var d=new air.Sound();d.load(new air.URLRequest(a.url));d.play(b)}};Ext.air.SystemMenu=function(){var b;if(air.NativeWindow.supportsMenu&&nativeWindow.systemChrome!=air.NativeWindowSystemChrome.NONE){b=new air.NativeMenu();nativeWindow.menu=b}if(air.NativeApplication.supportsMenu){b=air.NativeApplication.nativeApplication.menu}function a(f,e){for(var d=0,c=f.items.length;d<c;d++){if(f.items[d]["label"]==e){return f.items[d]}}return null}return{add:function(h,g,f){var e=a(b,h);if(!e){e=b.addItem(new air.NativeMenuItem(h));e.mnemonicIndex=f||0;e.submenu=new air.NativeMenu()}for(var d=0,c=g.length;d<c;d++){e.submenu.addItem(g[d]=="-"?new air.NativeMenuItem("",true):Ext.air.MenuItem(g[d]))}return e.submenu},get:function(){return b}}}();Ext.air.MenuItem=function(e){if(!e.isAction){e=new Ext.Action(e)}var b=e.initialConfig;var a=new air.NativeMenuItem(b.itemText||b.text);a.enabled=!b.disabled;if(!Ext.isEmpty(b.checked)){a.checked=b.checked}var d=b.handler;var c=b.scope;a.addEventListener(air.Event.SELECT,function(){d.call(c||window,b)});e.addComponent({setDisabled:function(f){a.enabled=!f},setText:function(f){a.label=f},setVisible:function(f){a.enabled=!f},setHandler:function(f,g){d=f;c=g},on:function(){}});return a};Ext.ns("Ext.air");Ext.air.MusicPlayer=Ext.extend(Ext.util.Observable,{activeSound:null,activeChannel:null,activeTransform:new air.SoundTransform(1,0),pausePosition:0,progressInterval:500,constructor:function(a){a=a||{};Ext.apply(this,a);this.addEvents("stop","pause","play","load","id3info","complete","progress","skip");Ext.air.MusicPlayer.superclass.constructor.call(this,a);this.onSoundFinishedDelegate=this.onSoundFinished.createDelegate(this);this.onSoundLoadDelegate=this.onSoundLoad.createDelegate(this);this.onSoundID3LoadDelegate=this.onSoundID3Load.createDelegate(this);Ext.TaskMgr.start({run:this.notifyProgress,scope:this,interval:this.progressInterval})},adjustVolume:function(a){this.activeTransform.volume=a;if(this.activeChannel){this.activeChannel.soundTransform=this.activeTransform}},stop:function(){this.pausePosition=0;if(this.activeChannel){this.activeChannel.stop();this.activeChannel=null}if(this.activeSound){this.activeSound.removeEventListener(air.Event.COMPLETE,this.onSoundLoadDelegate);this.activeSound.removeEventListener(air.Event.ID3,this.onSoundID3LoadDelegate);this.activeSound.removeEventListener(air.Event.SOUND_COMPLETE,this.onSoundFinishedDelegate)}},pause:function(){if(this.activeChannel){this.pausePosition=this.activeChannel.position;this.activeChannel.stop()}},play:function(a){if(a){this.stop();var b=new air.URLRequest(a);this.activeSound=new air.Sound();this.activeSound.addEventListener(air.Event.SOUND_COMPLETE,this.onSoundFinishedDelegate);this.activeSound.addEventListener(air.Event.COMPLETE,this.onSoundLoadDelegate);this.activeSound.addEventListener(air.Event.ID3,this.onSoundID3LoadDelegate);this.activeSound.load(b)}else{this.onSoundLoad()}},skipTo:function(a){if(this.activeChannel){this.activeChannel.stop();this.activeChannel=this.activeSound.play(a);this.activeChannel.soundTransform=this.activeTransform;this.fireEvent("skip",this.activeChannel,this.activeSound,a)}},hasActiveChannel:function(){return !!this.activeChannel},onSoundLoad:function(a){if(this.activeSound){if(this.activeChannel){this.activeChannel.stop()}this.activeChannel=this.activeSound.play(this.pausePosition);this.activeChannel.soundTransform=this.activeTransform;this.fireEvent("load",this.activeChannel,this.activeSound)}},onSoundFinished:function(a){this.fireEvent("complete",a)},onSoundID3Load:function(b){this.activeSound.removeEventListener(air.Event.ID3,this.onSoundID3LoadDelegate);var a=b.target.id3;this.fireEvent("id3info",a)},notifyProgress:function(){if(this.activeChannel&&this.activeSound){var a=100*(this.activeChannel.position/this.activeSound.length);if(a>99.7){this.onSoundFinished()}else{this.fireEvent("progress",this.activeChannel,this.activeSound)}}}});Ext.air.Notify=Ext.extend(Ext.air.NativeWindow,{winType:"notify",type:"lightweight",width:400,height:50,chrome:"none",transparent:true,alwaysOnTop:true,extraHeight:22,hideDelay:3000,msgId:"msg",iconId:"icon",icon:Ext.BLANK_IMAGE_URL,boxCls:"x-box",extAllCSS:"../extjs/resources/css/ext-all.css",xtpl:new Ext.XTemplate('<html><head><link rel="stylesheet" href="{extAllCSS}" /></head>',"<body>",'<div class="{boxCls}-tl"><div class="{boxCls}-tr"><div class="{boxCls}-tc"></div></div></div><div class="{boxCls}-ml"><div class="{boxCls}-mr"><div class="{boxCls}-mc">','<div id="{msgId}">',"<span>{msg}</span>",'<div id="{iconId}" style="float: right;"><img src="{icon}"></div>',"</div>",'</div></div></div><div class="{boxCls}-bl"><div class="{boxCls}-br"><div class="{boxCls}-bc"></div></div></div>',"</body>","</html>"),constructor:function(a){a=a||{};Ext.apply(this,a);a.html=this.xtpl.apply(this);Ext.air.Notify.superclass.constructor.call(this,a);this.getNative().alwaysInFront=true;this.onCompleteDelegate=this.onComplete.createDelegate(this);this.loader.addEventListener(air.Event.COMPLETE,this.onCompleteDelegate)},onComplete:function(a){this.loader.removeEventListener(air.Event.COMPLETE,this.onCompleteDelegate);this.show(a)},show:function(c){var b=c.target.window.document.getElementById(this.msgId).clientHeight+this.extraHeight;var a=air.Screen.mainScreen;var d=[0,0];d[0]=a.visibleBounds.bottomRight.x-this.width;d[1]=a.visibleBounds.bottomRight.y-this.height;this.moveTo(d[0],d[1]);Ext.air.Notify.superclass.show.call(this);this.close.defer(this.hideDelay,this)}});Ext.air.Clipboard=function(){var a=air.Clipboard.generalClipboard;return{hasData:function(b){return a.hasFormat(b)},setData:function(c,b){a.setData(c,b)},setDataHandler:function(c,b){a.setDataHandler(c,b)},getData:function(c,b){a.getData(c,b)},clear:function(){a.clear()},clearData:function(b){a.clearData(b)}}}();Ext.air.App=function(){return{launchOnStartup:function(a){air.NativeApplication.nativeApplication.startAtLogin=!!a},getActiveWindow:function(){return air.NativeApplication.activeWindow}}}();Ext.tree.LocalTreeLoader=Ext.extend(Ext.tree.TreeLoader,{requestData:function(b,d){if(this.fireEvent("beforeload",this,b,d)!==false){var c=Ext.urlDecode(this.getParams(b));var a=this.dataFn(b);this.processResponse(a,b,d);this.fireEvent("load",this,b,a)}else{if(typeof d=="function"){d()}}},processResponse:function(f,c,h){try{c.beginUpdate();for(var b=0,a=f.length;b<a;b++){var g=this.createNode(f[b]);if(g){c.appendChild(g)}}c.endUpdate();if(typeof h=="function"){h(this,c)}}catch(d){this.handleFailure(response)}},load:function(a,b){if(this.clearOnLoad){while(a.firstChild){a.removeChild(a.firstChild)}}if(this.doPreload(a)){if(typeof b=="function"){b()}}else{if(this.dataFn||this.fn){this.requestData(a,b)}}}});Ext.air.FileTreeLoader=Ext.extend(Ext.tree.LocalTreeLoader,{extensionFilter:false,dataFn:function(b){var a;if(b.attributes.url){a=this.directory.resolvePath(b.attributes.url)}else{a=this.directory}var d=[];var e=a.getDirectoryListing();for(i=0;i<e.length;i++){if(e[i].isDirectory||this.extensionFilter===false||this.extensionFilter===e[i].extension){d.push({text:e[i].name,url:e[i].url,extension:e[i].extension,leaf:!e[i].isDirectory})}}return d}});Ext.air.VideoPanel=Ext.extend(Ext.Panel,{autoResize:true,initComponent:function(){var a=new air.NetConnection();a.connect(null);this.stream=new runtime.flash.net.NetStream(a);this.stream.client={onMetaData:Ext.emptyFn};Ext.air.VideoPanel.superclass.initComponent.call(this);this.on("bodyresize",this.onVideoResize,this)},afterRender:function(){Ext.air.VideoPanel.superclass.afterRender.call(this);(function(){var a=this.body.getBox();this.video=new air.Video(this.getInnerWidth(),this.getInnerHeight());if(this.url){this.video.attachNetStream(this.stream);this.stream.play(this.url)}nativeWindow.stage.addChild(this.video);this.video.x=a.x;this.video.y=a.y}).defer(500,this)},onVideoResize:function(c,a,d){if(this.video&&this.autoResize){var b=this.getInnerWidth();var e=this.getInnerHeight();this.video.width=b;this.video.height=e;var f=this.body.getXY();if(f[0]!==this.video.x){this.video.x=f[0]}if(f[1]!==this.video.y){this.video.y=f[1]}}},loadVideo:function(a){this.stream.close();this.video.attachNetStream(this.stream);this.stream.play(a)}});Ext.reg("videopanel",Ext.air.VideoPanel);